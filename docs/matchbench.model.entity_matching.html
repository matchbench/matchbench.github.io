

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>matchbench.model.entity_matching package &mdash; MatchBench  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="MatchBench  documentation" href="index.html"/>
        <link rel="up" title="matchbench.model package" href="matchbench.model.html"/>
        <link rel="next" title="matchbench.model.schema_matching package" href="matchbench.model.schema_matching.html"/>
        <link rel="prev" title="matchbench.model.entity_alignment package" href="matchbench.model.entity_alignment.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> MatchBench
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="md_file/Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/UserGuides.html">User Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="md_file/DeveloperGuides.html">Developer Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">matchbench</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="matchbench.html">matchbench package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="matchbench.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="matchbench.dataset.html">matchbench.dataset package</a></li>
<li class="toctree-l4"><a class="reference internal" href="matchbench.evaluator.html">matchbench.evaluator package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="matchbench.model.html">matchbench.model package</a></li>
<li class="toctree-l4"><a class="reference internal" href="matchbench.pair_gen.html">matchbench.pair_gen package</a></li>
<li class="toctree-l4"><a class="reference internal" href="matchbench.trainer.html">matchbench.trainer package</a></li>
<li class="toctree-l4"><a class="reference internal" href="matchbench.utils.html">matchbench.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="matchbench.html#module-matchbench">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MatchBench</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">matchbench</a> &raquo;</li>
        
          <li><a href="matchbench.html">matchbench package</a> &raquo;</li>
        
          <li><a href="matchbench.model.html">matchbench.model package</a> &raquo;</li>
        
      <li>matchbench.model.entity_matching package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/matchbench.model.entity_matching.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="matchbench-model-entity-matching-package">
<h1>matchbench.model.entity_matching package<a class="headerlink" href="#matchbench-model-entity-matching-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="matchbench-model-entity-matching-deepmatcher-module">
<h2>matchbench.model.entity_matching.deepmatcher module<a class="headerlink" href="#matchbench-model-entity-matching-deepmatcher-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-matchbench.model.entity_matching.ditto">
<span id="matchbench-model-entity-matching-ditto-module"></span><h2>matchbench.model.entity_matching.ditto module<a class="headerlink" href="#module-matchbench.model.entity_matching.ditto" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.DKInjector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.ditto.</span></span><span class="sig-name descname"><span class="pre">DKInjector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.DKInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Inject domain knowledge to the data entry pairs.
.. attribute:: name</p>
<blockquote>
<div><p>the injector name</p>
<dl class="field-list simple">
<dt class="field-odd">type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.DKInjector.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.DKInjector.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.DKInjector.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.DKInjector.transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.DKInjector.transform_file">
<span class="sig-name descname"><span class="pre">transform_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.DKInjector.transform_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform all lines of a tsv file.
Run the knowledge injector. If the output already exists, just return the file name.
:param input_fn: the input file name
:type input_fn: <cite>str</cite>
:param overwrite: if true, then overwrite any cached output
:type overwrite: <cite>bool</cite>, <em>optional</em></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the output file name</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.ditto.</span></span><span class="sig-name descname"><span class="pre">Ditto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summarize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'drop_col'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_plm_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encodermodel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_aug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="matchbench.model.html#matchbench.model.base_model.EMModel" title="matchbench.model.base_model.EMModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EMModel</span></code></a></p>
<p>The class for <cite>Ditto</cite> approach</p>
<dl>
<dt>Class attributes:</dt><dd><p>Data/Feature generation
summarize (<cite>bool</cite>): If the input sequence will be summarized by retaining only the high TF-IDF tokens or not.
dk (<cite>str</cite>): If inject domain knowledge to the input sequences or not.
da (<cite>str</cite>): If train the Ditto model with MixDA, supporting operators <cite>“del”</cite> <cite>“swap”</cite> <cite>“drop_col”</cite> <cite>“append_col”</cite> <cite>“all”</cite>
max_length (<cite>int</cite>): Max sequence length.
batch_size (<cite>int</cite>): The batch size.
size (<cite>int</cite>): Maximum number for training.</p>
<p>Model architecture / Loss
alpha_aug (<cite>double</cite>): The parameters for np.random.beta.</p>
<p>Others
device (<cite>str</cite>): Device where data storage and model run
plm_path (<cite>str</cite>): The local pretrained language model path.
tokenizer (<cite>transformers.Tokenizer</cite>): User defined plm tokenizer.
encodermodel (<cite>transformers.PretrainedModel</cite>): User defined plm model.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto.calculate_loss">
<span class="sig-name descname"><span class="pre">calculate_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto.calculate_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the loss of the batch.
:param prediction: The result predicted by model Ditto.
:type prediction: <cite>torch.tensor</cite>
:param label: The true label.
:type label: <cite>torch.tensor</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.tensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the left, right, and the concatenation of left+right.
:param x1: A batch of ID’s
:type x1: <cite>LongTensor</cite>
:param x2: A batch of ID’s (augmented)
:type x2: <cite>LongTensor</cite>, <em>optional</em>, defaults to <cite>None</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Binary prediction.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto.load_source_target">
<span class="sig-name descname"><span class="pre">load_source_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_tgt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto.load_source_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare source and target data.
:param data_src: Source dataset.
:type data_src: <cite>datasets.dataset_dict.DatasetDict</cite>
:param data_tgt: Target dataset.
:type data_tgt: <cite>datasets.dataset_dict.DatasetDict</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> (<cite>torch.utils.data.DataLoader</cite>) – Dataloader for prediction.</p></li>
<li><p><strong>split</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“test”</cite>) – A string indicating which split the dataset is.</p></li>
<li><p><strong>threshold</strong> (<cite>float</cite>, <em>optional</em>, defaults to <cite>-1</cite>) – The threshold on the 0-class</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The true label.
<cite>List</cite> : The result predicted by Ditto model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>List</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto.prepare_dataloader">
<span class="sig-name descname"><span class="pre">prepare_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto.prepare_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare dataloaders for training and evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<cite>datasets.arrow_dataset.Dataset</cite>) – Train/valid/test pairs.</p></li>
<li><p><strong>split</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“train”</cite>) – A string indicating which split the dataset is.</p></li>
<li><p><strong>batch_size</strong> (<cite>int</cite>, <em>optional</em>, defaults to 32) – Batch_size for training or evaluating.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return dataloader for train/valid/test.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>tuple of torch.utils.data.Dataloader</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto.run_step">
<span class="sig-name descname"><span class="pre">run_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto.run_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The whole process training one batch (step).
:param batch:
:type batch: <cite>tuple of torch.tensor</cite>
:param device: cuda or cpu.
:type device: <cite>str</cite>, <em>optional</em>, defaults to <cite>“cuda”</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.tensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Ditto.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Ditto.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.DittoDataLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.ditto.</span></span><span class="sig-name descname"><span class="pre">DittoDataLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'roberta'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.DittoDataLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Ditto dataset</p>
<dl class="simple">
<dt>Class Attributes:</dt><dd><p>data (<cite>List of str</cite>): Data.
lm (<cite>str</cite>): The name of Pre-train language model.
max_len (<cite>int</cite>): Max sequence length.
size (<cite>int</cite>): Maximum number for training.
da (<cite>str</cite>): If train the Ditto model with MixDA, supporting operators <cite>“del”</cite> <cite>“swap”</cite> <cite>“drop_col”</cite> <cite>“append_col”</cite> <cite>“all”</cite>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.DittoDataLoader.pad">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.DittoDataLoader.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge a list of dataset items into a train/test batch
:param batch: a list of dataset items
:type batch: <cite>List of tuple</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>x1 of shape (batch_size, seq_len)
<cite>LongTensor</cite>: x2 of shape (batch_size, seq_len).</p>
<blockquote>
<div><p>Elements of x1 and x2 are padded to the same length</p>
</div></blockquote>
<p><cite>LongTensor</cite>: a batch of labels, (batch_size,)</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>LongTensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.GeneralDKInjector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.ditto.</span></span><span class="sig-name descname"><span class="pre">GeneralDKInjector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.GeneralDKInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#matchbench.model.entity_matching.ditto.DKInjector" title="matchbench.model.entity_matching.ditto.DKInjector"><code class="xref py py-class docutils literal notranslate"><span class="pre">DKInjector</span></code></a></p>
<p>The domain-knowledge injector for publication and business data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.GeneralDKInjector.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.GeneralDKInjector.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize spacy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.GeneralDKInjector.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.GeneralDKInjector.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a data entry.
Use NER to regconize the product-related named entities and
mark them in the sequence. Normalize the numbers into the same format.
:param entry: the serialized data entry
:type entry: <cite>str</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the transformed entry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.ProductDKInjector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.ditto.</span></span><span class="sig-name descname"><span class="pre">ProductDKInjector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.ProductDKInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#matchbench.model.entity_matching.ditto.DKInjector" title="matchbench.model.entity_matching.ditto.DKInjector"><code class="xref py py-class docutils literal notranslate"><span class="pre">DKInjector</span></code></a></p>
<p>The domain-knowledge injector for product data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.ProductDKInjector.initialize">
<span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.ProductDKInjector.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize spacy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.ProductDKInjector.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.ProductDKInjector.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a data entry.
Use NER to regconize the product-related named entities and
mark them in the sequence. Normalize the numbers into the same format.
:param entry: the serialized data entry
:type entry: <cite>str</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the transformed entry</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Summarizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.ditto.</span></span><span class="sig-name descname"><span class="pre">Summarizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Summarizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>To summarize a data entry pair into length up to the max sequence length.
:param task_config: the task configuration
:type task_config: <cite>Dictionary</cite>
:param lm: the language model (bert, albert, or distilbert)
:type lm: <cite>str</cite></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Summarizer.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Summarizer.config" title="Permalink to this definition">¶</a></dt>
<dd><p>the task configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Dictionary</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Summarizer.tokenizer">
<span class="sig-name descname"><span class="pre">tokenizer</span></span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Summarizer.tokenizer" title="Permalink to this definition">¶</a></dt>
<dd><p>a tokenizer from the huggingface library</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Tokenizer</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Summarizer.build_index">
<span class="sig-name descname"><span class="pre">build_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Summarizer.build_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the idf index.
Store the index and vocabulary in self.idf and self.vocab.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Summarizer.get_len">
<span class="sig-name descname"><span class="pre">get_len</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Summarizer.get_len" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sentence_piece length of a token.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Summarizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Summarizer.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize one single example.
Only retain tokens of the highest tf-idf
:param row: a matching example of two data entries and a binary label, separated by tab
:type row: <cite>str</cite>
:param max_len: the maximum sequence length to be summarized to
:type max_len: <cite>int</cite>, <em>optional</em></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the summarized example</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.ditto.Summarizer.transform_file">
<span class="sig-name descname"><span class="pre">transform_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.ditto.Summarizer.transform_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Summarize all lines of a tsv file.
Run the summarizer. If the output already exists, just return the file name.
:param input_fn: the input file name
:type input_fn: <cite>str</cite>
:param max_len: the max sequence len
:type max_len: <cite>int</cite>, <em>optional</em>
:param overwrite: if true, then overwrite any cached output
:type overwrite: <cite>bool</cite>, <em>optional</em></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the output file name</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-matchbench.model.entity_matching.jointbert">
<span id="matchbench-model-entity-matching-jointbert-module"></span><h2>matchbench.model.entity_matching.jointbert module<a class="headerlink" href="#module-matchbench.model.entity_matching.jointbert" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BCEWithLogitsLoss">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">BCEWithLogitsLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_neg_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BCEWithLogitsLoss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">BertDataLoaderJoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bert-base-uncased'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p>
<p>DataLoader class for <cite>JointBert</cite> approach.
Class Attributes:</p>
<blockquote>
<div><p>batch_size (<cite>int</cite>): The batch size.
file (<cite>pandas.DataFrame</cite>): The dataset.
valid_file (<cite>List</cite>): The valid ids.
valid_batch_size (<cite>int</cite>): The valid batch size.
shuffle (<cite>bool</cite>, defaults to <cite>True</cite>): If set <cite>shuffle`=True, internally the RandomSampler will be used, which just permutes the indices of all samples.
validation_split (`int</cite>, defaults to <cite>-1</cite>): If need to split dataset to get valid or not.
num_workers (<cite>int</cite>): The number of subprocesses that DataLoader instance will use to load data.
tokenizer_name (<cite>str</cite>): The name of PLM tokenizer.
max_length (<cite>int</cite>): Max sequence length.
mlm (<cite>bool</cite>): If use masked-LM training in preparing masked tokens or not.</p>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.batch_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">T_co</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.drop_last">
<span class="sig-name descname"><span class="pre">drop_last</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.drop_last" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.num_workers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.pin_memory">
<span class="sig-name descname"><span class="pre">pin_memory</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.pin_memory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.prefetch_factor">
<span class="sig-name descname"><span class="pre">prefetch_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.prefetch_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.sampler">
<span class="sig-name descname"><span class="pre">sampler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sampler</span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.sampler" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.split_validation">
<span class="sig-name descname"><span class="pre">split_validation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.split_validation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get valid DataLoader.
:returns: The valid DataLoader.
:rtype: <cite>torch.utils.data.DataLoader</cite></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.timeout">
<span class="sig-name descname"><span class="pre">timeout</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.BertDataLoaderJoint.timeout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">DataCollatorWithPadding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">PreTrainedTokenizer</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerFast</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PaddingStrategy</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_to_multiple_of</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlm_probability</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.15</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Data collator that will dynamically pad the inputs received.
Class Attributes:</p>
<blockquote>
<div><p>tokenizer (<code class="xref py py-class docutils literal notranslate"><span class="pre">PreTrainedTokenizer</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">PreTrainedTokenizerFast</span></code>): The tokenizer used for encoding the data.
padding (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> or <code class="xref py py-class docutils literal notranslate"><span class="pre">PaddingStrategy</span></code>, <cite>optional</cite>, defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>):</p>
<blockquote>
<div><p>Select a strategy to pad the returned sequences (according to the model’s padding side and padding
index) among:
* <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">'longest'</span></code>: Pad to the longest sequence in the batch (or no padding if only a</p>
<blockquote>
<div><p>single sequence if provided).</p>
</div></blockquote>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">'max_length'</span></code>: Pad to a maximum length specified with the argument <a class="reference internal" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.max_length" title="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.max_length"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max_length</span></code></a> or to the
maximum acceptable input length for the model if that argument is not provided.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">'do_not_pad'</span></code> (default): No padding (i.e., can output a batch with sequences of
different lengths).</p></li>
</ul>
</div></blockquote>
<p>max_length (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, <cite>optional</cite>): Maximum length of the returned list and optionally padding length (see above).
pad_to_multiple_of (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, <cite>optional</cite>):</p>
<blockquote>
<div><p>If set will pad the sequence to a multiple of the provided value.
This is especially useful to enable the use of Tensor Cores on NVIDIA hardware with compute capability
&gt;= 7.5 (Volta).</p>
</div></blockquote>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.mask_tokens">
<span class="sig-name descname"><span class="pre">mask_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.mask_tokens" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare masked tokens inputs/labels for masked language modeling: 80% MASK, 10% random, 10% original.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.max_length">
<span class="sig-name descname"><span class="pre">max_length</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.max_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.mlm">
<span class="sig-name descname"><span class="pre">mlm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.mlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.mlm_probability">
<span class="sig-name descname"><span class="pre">mlm_probability</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.15</span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.mlm_probability" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.pad_to_multiple_of">
<span class="sig-name descname"><span class="pre">pad_to_multiple_of</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.pad_to_multiple_of" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.padding">
<span class="sig-name descname"><span class="pre">padding</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PaddingStrategy</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.tokenizer">
<span class="sig-name descname"><span class="pre">tokenizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><span class="pre">PreTrainedTokenizer</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">PreTrainedTokenizerFast</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.DataCollatorWithPadding.tokenizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">JointBert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_neg_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes_multi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1013</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freeze_bert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="matchbench.model.html#matchbench.model.base_model.EMModel" title="matchbench.model.base_model.EMModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EMModel</span></code></a></p>
<p>The class for <cite>JointBert</cite> approach</p>
<dl>
<dt>Class attributes:</dt><dd><p>Data/Feature generation
pos_neg_ratio (<cite>int</cite>): The ratio of neg/pos.</p>
<p>Model architecture / Loss
weight_decay (<cite>float</cite>): Weight decay.
num_classes_multi (<cite>int</cite>): The output number of entity identifier classification layer.
num_classes (<cite>int</cite>): The output number of matching classification layer.</p>
<p>Others
device (<cite>str</cite>): Device where data storage and model run.
freeze_bert (<cite>bool</cite>): If freeze the weights of bert model or not.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert.calc_weights_label">
<span class="sig-name descname"><span class="pre">calc_weights_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainloader</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert.calc_weights_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Calc weights for entity identifier loss function.
:param trainloader: Train data loader.
:type trainloader: <cite>BertDataLoaderJoint</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attn_masks</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seq</strong> (<cite>Tensor</cite>) – The sequences.</p></li>
<li><p><strong>token_ids</strong> (<cite>Tensor</cite>) – Tensor of shape [B, T] containing token ids of sequences.</p></li>
<li><p><strong>attn_masks</strong> (<cite>Tensor</cite>) – Tensor of shape [B, T] containing attention masks to be used to avoid contibution of PAD tokens.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The probability of the positive class(match).
<cite>Tensor</cite> : The entity identifier of the left entity descriptions.
<cite>Tensor</cite> : The entity identifier of the right entity descriptions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>Tensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert.pair_generator">
<span class="sig-name descname"><span class="pre">pair_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tableA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert.pair_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate train/valid/test data loader.
:param data_src: Source dataset.
:type data_src: <cite>datasets.dataset_dict.DatasetDict</cite>
:param data_tgt: Target dataset.
:type data_tgt: <cite>datasets.dataset_dict.DatasetDict</cite>
:param train: Train pairs.
:type train: <cite>datasets.arrow_dataset.Dataset</cite>
:param valid: Valid pairs.
:type valid: <cite>datasets.arrow_dataset.Dataset</cite>
:param test: test pairs.
:type test: <cite>datasets.arrow_dataset.Dataset</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Train data loader.
<cite>torch.utils.data.DataLoader</cite> : Valid data loader.
<cite>BertDataLoaderJoint</cite> : Test data loader.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>BertDataLoaderJoint</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> (<cite>torch.utils.data.DataLoader</cite>) – Dataloader for prediction.</p></li>
<li><p><strong>split</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“test”</cite>) – A string indicating which split the dataset is.</p></li>
<li><p><strong>threshold</strong> (<cite>float</cite>, <em>optional</em>, defaults to <cite>-1</cite>) – the threshold on the 0-class</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The true label.
<cite>List</cite> : The result predicted by JointBert model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>List</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert.prepare_dataloader">
<span class="sig-name descname"><span class="pre">prepare_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert.prepare_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare dataloaders for training and evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<cite>datasets.arrow_dataset.Dataset</cite>) – Train/valid/test pairs.</p></li>
<li><p><strong>split</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“train”</cite>) – A string indicating which split the dataset is.</p></li>
<li><p><strong>batch_size</strong> (<cite>int</cite>, <em>optional</em>, defaults to 32) – Batch_size for training or evaluating.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return dataloader for train/valid/test.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>tuple of torch.utils.data.Dataloader</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert.run_step">
<span class="sig-name descname"><span class="pre">run_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert.run_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The whole process training one batch (step).
:param batch:
:type batch: <cite>tuple of torch.tensor</cite>
:param device: cuda or cpu.
:type device: <cite>str</cite>, <em>optional</em>, defaults to <cite>“cuda”</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.tensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBert.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBert.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.JointBertPrep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">JointBertPrep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.JointBertPrep" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Prepare data for JointBert.
Class Attributes:</p>
<blockquote>
<div><p>data (<cite>pandas.DataFrame</cite>): The data needed to prepare.
tokenizer_name (<cite>str</cite>): The name of PLM tokenizer.
max_length (<cite>int</cite>): Max sequence length.</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.assign_clusterid">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">assign_clusterid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">identifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_id_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_id_amount</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.assign_clusterid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.cluster_id_process">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">cluster_id_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tableA</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.cluster_id_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cluster ids for entities in train/valid/test dataset.
:param data_src: Source dataset.
:type data_src: <cite>datasets.dataset_dict.DatasetDict</cite>
:param data_tgt: Target dataset.
:type data_tgt: <cite>datasets.dataset_dict.DatasetDict</cite>
:param train: Train pairs.
:type train: <cite>datasets.arrow_dataset.Dataset</cite>
:param valid: Valid pairs.
:type valid: <cite>datasets.arrow_dataset.Dataset</cite>
:param test: test pairs.
:type test: <cite>datasets.arrow_dataset.Dataset</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Train dataset with cluster ids.
<cite>List of str</cite> : Pair ids for valid dataset.
<cite>pandas.DataFrame</cite> : Test dataset with cluster ids.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>pandas.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.get_cluster_id">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">get_cluster_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_id_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_id_amount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.get_cluster_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.get_encoder_deepmatcher">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">get_encoder_deepmatcher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.get_encoder_deepmatcher" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.jointbert.process_to_bert">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.jointbert.</span></span><span class="sig-name descname"><span class="pre">process_to_bert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutting_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_encoder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.jointbert.process_to_bert" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-matchbench.model.entity_matching.robem">
<span id="matchbench-model-entity-matching-robem-module"></span><h2>matchbench.model.entity_matching.robem module<a class="headerlink" href="#module-matchbench.model.entity_matching.robem" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.ASLSingleLabel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">ASLSingleLabel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma_pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_neg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.ASLSingleLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.ASLSingleLabel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.ASLSingleLabel.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.ASLSingleLabel.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.ASLSingleLabel.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.AugMode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">AugMode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.AugMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>An enumeration.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.AugMode.RANDOM_DEL">
<span class="sig-name descname"><span class="pre">RANDOM_DEL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.AugMode.RANDOM_DEL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.AugMode.REMOVE_CHAR_LESS_THAN">
<span class="sig-name descname"><span class="pre">REMOVE_CHAR_LESS_THAN</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.AugMode.REMOVE_CHAR_LESS_THAN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.AugMode.REMOVE_STOP_WORD">
<span class="sig-name descname"><span class="pre">REMOVE_STOP_WORD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.AugMode.REMOVE_STOP_WORD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.AugMode.ROB_ALL">
<span class="sig-name descname"><span class="pre">ROB_ALL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.AugMode.ROB_ALL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.AugMode.ROB_SFL">
<span class="sig-name descname"><span class="pre">ROB_SFL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.AugMode.ROB_SFL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.AugMode.ROB_SWAP">
<span class="sig-name descname"><span class="pre">ROB_SWAP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.AugMode.ROB_SWAP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.BasicAug">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">BasicAug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#matchbench.model.entity_matching.robem.AugMode" title="matchbench.model.entity_matching.robem.AugMode"><span class="pre">AugMode</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AugMode.RANDOM_DEL</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.BasicAug" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.BasicAug.augment">
<span class="sig-name descname"><span class="pre">augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.BasicAug.augment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.EmDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">EmDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatgt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aug_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.EmDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Robem Dataset.
Class attributes:</p>
<blockquote>
<div><p>datasrc (<cite>pandas.DataFrame</cite>): Source dataset.
datatgt (<cite>pandas.DataFrame</cite>): Target dataset.
match (<cite>datasets.arrow_dataset.Dataset</cite>): The matching relationship for pairs.
mode (<cite>str</cite>): Mode for data preparation, the options are <cite>train</cite>,`valid`,`test`.
transform (<cite>List of tokenizer</cite>): The tokenizers used in data preparation, such as <cite>transformers.BertTokenizer</cite> and <cite>transformers.RobertaTokenizer</cite>.
device (<cite>str</cite>): Device where data storage and model run.
sentence_size (<cite>int</cite>): Max sentence size.
aug_size (<cite>int</cite>): The number of augmentation data corresponding to a piece of data.</p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.EmDataset.input_serializer">
<span class="sig-name descname"><span class="pre">input_serializer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_full</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_full</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.EmDataset.input_serializer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.Highway">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">Highway</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.Highway" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.Highway.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.Highway.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.Highway.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.Highway.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">RobEM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataprep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrained_lm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'roberta-base'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sent_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wce'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neg_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addsep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="matchbench.model.html#matchbench.model.base_model.EMModel" title="matchbench.model.base_model.EMModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EMModel</span></code></a></p>
<p>The class for <cite>Robem</cite> approach</p>
<dl>
<dt>Class attributes:</dt><dd><p>Data/Feature generation
dataprep (<cite>torch.utils.data.Dataset</cite> or his subclass): The Dataset for <cite>Robem</cite> data preparation.
sent_size (<cite>int</cite>): Max sequence length.</p>
<p>Model architecture / Loss
deep_classifier (<cite>bool</cite>): If enable deep classifier or not.
loss_type (<cite>str</cite>): The name of loss function for RobEM approach.
neg_weight (<cite>float</cite>): Wce &amp; asl loss weight for non-match samples.
pos_weight (<cite>float</cite>): Wce &amp; asl loss weight for match samples.
amp_scaler (<cite>bool</cite>): If use auto mixed precision or not.
addsep (<cite>bool</cite>): If add attribute separator as special token for to tokenizer and model(LM) or not.</p>
<p>Others
device (<cite>str</cite>): Device where data storage and model run.
pretrained_lm (<cite>str</cite>): The name of PLM.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.context_forward">
<span class="sig-name descname"><span class="pre">context_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.context_forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.context_similarity_layers">
<span class="sig-name descname"><span class="pre">context_similarity_layers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.context_similarity_layers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">concat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>“Forward function of the Robem.
:param x1: The left.
:type x1: <cite>Tensor</cite>
:param x2: The right.
:type x2: <cite>Tensor</cite>
:param concat: The concatenation of left and right.
:type concat: <cite>Tensor</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Binary prediction.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>Tensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.get_lm">
<span class="sig-name descname"><span class="pre">get_lm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.get_lm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.get_lm_class">
<span class="sig-name descname"><span class="pre">get_lm_class</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.get_lm_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.get_lm_dim">
<span class="sig-name descname"><span class="pre">get_lm_dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.get_lm_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.get_tokenizers">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_tokenizers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_special_token</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.get_tokenizers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.has_type_token">
<span class="sig-name descname"><span class="pre">has_type_token</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.has_type_token" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.load_source_target">
<span class="sig-name descname"><span class="pre">load_source_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_tgt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.load_source_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare source and target data.
:param data_src: Source dataset.
:type data_src: <cite>datasets.dataset_dict.DatasetDict</cite>
:param data_tgt: Target dataset.
:type data_tgt: <cite>datasets.dataset_dict.DatasetDict</cite></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader</strong> (<cite>torch.utils.data.DataLoader</cite>) – Dataloader for prediction.</p></li>
<li><p><strong>split</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“test”</cite>) – A string indicating which split the dataset is.</p></li>
<li><p><strong>threshold</strong> (<cite>float</cite>, <em>optional</em>, defaults to <cite>-1</cite>) – The threshold on the 0-class</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The true label.
<cite>List</cite> : The result predicted by Robem model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>List</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.prepare_dataloader">
<span class="sig-name descname"><span class="pre">prepare_dataloader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.prepare_dataloader" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare dataloaders for training and evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<cite>datasets.arrow_dataset.Dataset</cite>) – Train/valid/test pairs.</p></li>
<li><p><strong>split</strong> (<cite>str</cite>, <em>optional</em>, defaults to <cite>“train”</cite>) – A string indicating which split the dataset is.</p></li>
<li><p><strong>batch_size</strong> (<cite>int</cite>, <em>optional</em>, defaults to 32) – Batch_size for training or evaluating.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return dataloader for train/valid/test.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>tuple of torch.utils.data.Dataloader</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.reset_weights">
<span class="sig-name descname"><span class="pre">reset_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.reset_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.resize_embedding">
<span class="sig-name descname"><span class="pre">resize_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_len</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.resize_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.run_step">
<span class="sig-name descname"><span class="pre">run_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.run_step" title="Permalink to this definition">¶</a></dt>
<dd><p>The whole process training one batch (step).
:param batch:
:type batch: <cite>tuple of torch.tensor</cite>
:param device: cuda or cpu.
:type device: <cite>str</cite>, <em>optional</em>, defaults to <cite>“cuda”</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>torch.tensor</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobEM.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobEM.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobertaClassificationHead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">RobertaClassificationHead</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobertaClassificationHead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Head for sentence-level classification tasks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobertaClassificationHead.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobertaClassificationHead.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobertaClassificationHead.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobertaClassificationHead.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobustAugmenter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">RobustAugmenter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">[SEP]</span> <span class="pre">'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobustAugmenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.RobustAugmenter.augment_sent">
<span class="sig-name descname"><span class="pre">augment_sent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#matchbench.model.entity_matching.robem.AugMode" title="matchbench.model.entity_matching.robem.AugMode"><span class="pre">AugMode</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">AugMode.ROB_ALL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_shuffler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_swap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">ATTR</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_swap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.RobustAugmenter.augment_sent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.SimpleClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">SimpleClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.SimpleClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.SimpleClassifier.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">enc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.SimpleClassifier.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.SimpleClassifier.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#matchbench.model.entity_matching.robem.SimpleClassifier.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.Summarizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">Summarizer</span></span><a class="headerlink" href="#matchbench.model.entity_matching.robem.Summarizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for summarizer.</p>
<dl class="py method">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.Summarizer.summarize">
<span class="sig-name descname"><span class="pre">summarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.Summarizer.summarize" title="Permalink to this definition">¶</a></dt>
<dd><p>To summarize text into length up to the max sequence length.
:param text: The text need to summarize.
:type text: <cite>str</cite>
:param max_len: Max sequence length.
:type max_len: <cite>int</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The result after summarizing.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.cosine_similarity">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">cosine_similarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#matchbench.model.entity_matching.robem.cosine_similarity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cosine similarity between x1 and x2, computed along dim.</p>
<div class="math notranslate nohighlight">
\[\text{similarity} = \dfrac{x_1 \cdot x_2}{\max(\Vert x_1 \Vert _2 \cdot \Vert x_2 \Vert _2, \epsilon)}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> (<em>Tensor</em>) – First input.</p></li>
<li><p><strong>x2</strong> (<em>Tensor</em>) – Second input (of size matching x1).</p></li>
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><em>optional</em>) – Dimension of vectors. Default: 1</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>optional</em>) – Small value to avoid division by zero.
Default: 1e-8</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input: <span class="math notranslate nohighlight">\((\ast_1, D, \ast_2)\)</span> where D is at position <cite>dim</cite>.</p></li>
<li><p>Output: <span class="math notranslate nohighlight">\((\ast_1, \ast_2)\)</span> where 1 is at position <cite>dim</cite>.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cosine_similarity</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="matchbench.model.entity_matching.robem.set_to_device">
<span class="sig-prename descclassname"><span class="pre">matchbench.model.entity_matching.robem.</span></span><span class="sig-name descname"><span class="pre">set_to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#matchbench.model.entity_matching.robem.set_to_device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="matchbench-model-entity-matching-rotom-module">
<h2>matchbench.model.entity_matching.rotom module<a class="headerlink" href="#matchbench-model-entity-matching-rotom-module" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-contents">
<h2>Module contents<a class="headerlink" href="#module-contents" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="matchbench.model.schema_matching.html" class="btn btn-neutral float-right" title="matchbench.model.schema_matching package" accesskey="n">Next →</a>
      
      
        <a href="matchbench.model.entity_alignment.html" class="btn btn-neutral" title="matchbench.model.entity_alignment package" accesskey="p">← Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, MatchBench group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE: 'true'
        };
    </script>
      <script type="text/javascript" src="_static/documentation_options.js"></script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/_sphinx_javascript_frameworks_compat.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/sphinx_highlight.js"></script>
      <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>